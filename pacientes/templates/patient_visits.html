{% extends 'base.html' %}
{% block content %}

<div class="container card shadow p-4 mt-3">
    <h1>Visitas de {{ patient.nombres }} {{ patient.apellidos }}</h1>
    <hr>

    <div class="mb-3">
        <a href="{% url 'patients_list' %}" class="btn btn-link" style="text-decoration:none">üîô Volver a la lista de pacientes</a>
    </div>

    <div class="mb-3">
        <a href="{% url 'create_psicologia_consultation' patient.id %}" class="btn btn-outline-primary btn-sm">+ Nueva consulta Psicolog√≠a</a>
        <a href="{% url 'create_neumologia_consultation' patient.id %}" class="btn btn-outline-primary btn-sm">+ Nueva consulta Neumolog√≠a</a>
    </div>

    <hr>

    <!-- CONSULTAS DE PSICOLOG√çA -->
    <h4 class="mt-4">Consultas de Psicolog√≠a</h4>
    {% if psicologia_consultas %}
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Motivo</th>
                    <th>Profesional</th>
                    <th>Observaciones</th>
                </tr>
            </thead>
            <tbody>
                {% for consulta in psicologia_consultas %}
                <tr>
                    <td>{{ consulta.fecha_consulta }}</td>
                    <td>{{ consulta.motivo_consulta|truncatechars:50 }}</td>
                    <td>{{ consulta.profesional.username }}</td>
                    <td>{{ consulta.observaciones|default:"-" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No hay consultas de Psicolog√≠a registradas.</p>
    {% endif %}

    <!-- CONSULTAS DE NEUMOLOG√çA -->
    <h4 class="mt-5">Consultas de Neumolog√≠a</h4>
    {% if neumologia_consultas %}
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Motivo</th>
                    <th>Profesional</th>
                    <th>Presi√≥n arterial</th>
                    <th>Frecuencia card√≠aca</th>
                </tr>
            </thead>
            <tbody>
                {% for consulta in neumologia_consultas %}
                <tr>
                    <td>{{ consulta.fecha_consulta }}</td>
                    <td>{{ consulta.motivo_consulta|truncatechars:50 }}</td>
                    <td>{{ consulta.profesional.username }}</td>
                    <td>{{ consulta.presion_arterial|default:"-" }}</td>
                    <td>{{ consulta.frecuencia_cardiaca|default:"-" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No hay consultas de Neumolog√≠a registradas.</p>
    {% endif %}
</div>

{% endblock %}
